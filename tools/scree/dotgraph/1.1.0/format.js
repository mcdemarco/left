window.storyFormat({"description":"A proofing format for creating Graphviz graphs.","author":"M. C. DeMarco","image":"icon.svg","name":"DotGraph","url":"https://bitbucket.org/mcdemarco/dotgraph","version":"1.1.0","proofing":true,"source":"<!DOCTYPE html>\n<html>\n<head>\n<title>\n{{STORY_NAME}}\n</title>\n<meta charset=\"utf-8\">\n<script src=\"https://mcdemarco.net/tools/scree/dotgraph/viz.js\" type=\"text/javascript\"></script>\n</head>\n<body>\n\t<h1>DotGraph Proofing Format</h1>\n\t<div>\n\t\tIf rendering of the graph fails (and you only see the dot source file) or if you want a different format, the dot source can also be rendered into a graph using the free desktop program <a href=\"http://www.graphviz.org/\">Graphviz</a>, or rendered online at <a href=\"http://stamm-wilbrandt.de/GraphvizFiddle/\">GraphvizFiddle</a> or <a href=\"http://www.webgraphviz.com\">WebGraphviz</a>.\n\t</div>\n\t<h2>Graph (SVG)</h2>\n\t<div id=\"graph\"></div>\n\t<h2>Dot Source</h2>\n\t<pre id=\"dotfile\"></pre>\n\t\n{{STORY_DATA}}\n\n<script>(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nwindow.onload=function(){\"undefined\"==typeof window.DotGraph&&(window.DotGraph={convert:function(){var t=this.export();document.getElementById(\"dotfile\").innerHTML=t,document.getElementById(\"graph\").innerHTML=Viz(t,\"svg\")},export:function(){var t=[];t.push(\"digraph \");var e=window.document.getElementsByTagName(\"tw-storydata\");e?t.push(this.scrub(e[0].getAttribute(\"name\"))):t.push(\"UNTITLED\"),t.push(\" {\\r\\n\\r\\n\");for(var n=window.document.getElementsByTagName(\"tw-passagedata\"),r=0;r<n.length;++r)t.push(this.buildPassageFromElement(n[r]));return t.push(\"}\\r\\n\"),t.join(\"\")},buildPassageFromElement:function(t){var e,n=t.getAttribute(\"name\");n?\"Start\"==n&&(e=\"style=filled\"):n=this.scrub(\"Untitled Passage\");var r=t.textContent;return this.buildPassage(n,e,r)},buildPassage:function(t,e,n){var r=[],s=this.scrub(t);return r.push(s),e&&r.push(\" [\",e,\"]\"),r.push(\"\\r\\n\",this.extractLinks(n,s),\"\\r\\n\"),r.join(\"\")},extractLink:function(t){var e=t.indexOf(\"|\");if(e!=-1)t=t.substr(e+1);else{var n=t.indexOf(\"->\");if(n!=-1)t=t.substr(n+2);else{var r=t.indexOf(\"<-\");r!=-1&&(t=t.substr(0,r))}}return t},extractLinks:function(t,e){var n,r=\"\",s=/\\[\\[(.*?)\\]\\]/g;if(t)for(t=t.replace(/\\/\\*.*\\*\\//g,\"\"),t=t.replace(/^\\/\\/.*(\\r\\n?|\\n)/g,\"\");null!==(n=s.exec(t));){var i=this.extractLink(n[1]);/^\\w+:\\/\\/\\/?\\w/i.test(i)||(r+=e+\" -> \"+this.scrub(i)+\"\\r\\n\")}return r},scrub:function(t){return t&&(t=t.replace(/\"/gm,'\\\\\"'),t='\"'+t+'\"'),t}}),window.DotGraph.convert()};\n},{}]},{},[1]);\n</script>\n</body>\n</html>\n"});